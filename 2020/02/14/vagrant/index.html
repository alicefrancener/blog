<!DOCTYPE html><html lang="pt"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> [object Object] · Houston, we've had a problem</title><meta name="description" content="[object Object] - Alice Francener"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/notebook/favicon.png"><link rel="stylesheet" href="/notebook/css/hermes.css"><link rel="search" type="application/opensearchdescription+xml" href="https://alicefrancener.github.io/atom.xml" title="Houston, we've had a problem"><meta name="generator" content="Hexo 4.0.0"><link rel="alternate" href="/notebook/atom.xml" title="Houston, we've had a problem" type="application/atom+xml">
</head><body><div class="wrap"><header><a class="logo-link" href="/notebook/"><img src="/notebook/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a class="nav-list-link" href="/notebook/" target="_self">BLOG</a></li><li class="nav-list-item"><a class="nav-list-link" href="https://github.com/alicefrancener" target="_blank">GITHUB</a></li><li class="nav-list-item"><a class="nav-list-link" href="/notebook/archives/" target="_self">ARCHIVE</a></li><li class="nav-list-item"><a class="nav-list-link" href="/notebook/tags/" target="_self">TAGS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">[object Object]</h1><div class="post-info">14 de Fev de 2020</div><div class="post-content"><h1 id="Vagrant"><a href="#Vagrant" class="headerlink" title="Vagrant"></a>Vagrant</h1><ol>
<li><a href="#primeiros-passos">Primeiros passos</a></li>
<li><a href="#configura%c3%a7%c3%a3o-da-rede">Configuração da rede</a><ul>
<li><a href="#forward-ports">Forward Ports</a></li>
<li></li>
</ul>
</li>
</ol>
<h2 id="Primeiros-passos"><a href="#Primeiros-passos" class="headerlink" title="Primeiros passos"></a>Primeiros passos</h2><h3 id="Instalar"><a href="#Instalar" class="headerlink" title="Instalar"></a>Instalar</h3><ul>
<li>Instalar <strong>Vagrant</strong></li>
<li>Instalar Hypervisor (monitor de máquina virtual): no caso utilizei <a href="https://www.vagrantup.com/docs/virtualbox/" target="_blank" rel="noopener">VirtualBox</a> compatível com Vagrant</li>
</ul>
<h3 id="Criar-e-subir-maquina-virtual"><a href="#Criar-e-subir-maquina-virtual" class="headerlink" title="Criar e subir máquina virtual"></a>Criar e subir máquina virtual</h3><ul>
<li>Criar um diretório para os arquivos</li>
<li>Escolher <a href="https://www.vagrantup.com/intro/getting-started/boxes.html" target="_blank" rel="noopener">box</a></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># criar diretorio</span></span><br><span class="line">mkdir &lt;nome-do-diretorio&gt;</span><br><span class="line"><span class="built_in">cd</span> &lt;nome-do-diretorio&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># definir configurações da máquina virtual (nesse caso Ubuntu 12.04 =&gt; hashicorp/precise64) - cria o arquivo Vagrantfile</span></span><br><span class="line">vagrant init &lt;box-name&gt;</span><br><span class="line">vagrant init hashicorp/precise64</span><br><span class="line"></span><br><span class="line"><span class="comment"># criar (baixar e importar a box) e aplicar as configurações da máquina virtual</span></span><br><span class="line">vagrant up</span><br></pre></td></tr></table></figure>

<h3 id="Checar-status"><a href="#Checar-status" class="headerlink" title="Checar status"></a>Checar status</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vagrant status</span><br></pre></td></tr></table></figure>

<p>Na VirtualBox também é possível ver o status e se está funcionando.</p>
<h3 id="Conectar-a-maquina-virtual-com-ssh"><a href="#Conectar-a-maquina-virtual-com-ssh" class="headerlink" title="Conectar à máquina virtual com ssh"></a>Conectar à máquina virtual com <code>ssh</code></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vagrant ssh</span><br><span class="line"></span><br><span class="line"><span class="comment"># mostra as configurações ssh</span></span><br><span class="line">vagrant ssh-config</span><br><span class="line"></span><br><span class="line"><span class="comment"># desconectar da máquina</span></span><br><span class="line"><span class="built_in">logout</span></span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure>

<h3 id="Comandos-basicos"><a href="#Comandos-basicos" class="headerlink" title="Comandos básicos"></a>Comandos básicos</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># subir a máquina</span></span><br><span class="line">vagrant up</span><br><span class="line"></span><br><span class="line"><span class="comment"># para a máquina</span></span><br><span class="line">vagrant halt</span><br><span class="line"></span><br><span class="line"><span class="comment"># destruir a máquina</span></span><br><span class="line">vagrant destroy</span><br><span class="line"></span><br><span class="line"><span class="comment"># reload da máquina (vagrant halt &amp;&amp; vagrant up)</span></span><br><span class="line">vagrant reload</span><br></pre></td></tr></table></figure>

<p><a href="https://www.vagrantup.com/docs/cli/" target="_blank" rel="noopener">Vagrant &gt; Comandos</a></p>
<h2 id="Configuracao-da-rede"><a href="#Configuracao-da-rede" class="headerlink" title="Configuração da rede"></a>Configuração da rede</h2><p>Conectados à máquina virtual (com <code>vagrant ssh</code>), para instalar um serviço como o servidor Nginx devemos atualizar a lista de pacotes e depois instalar o programa.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line"></span><br><span class="line">sudo apt-get install -y nginx</span><br></pre></td></tr></table></figure>

<p>O Nginx já estará rodando e para confirmar usar <code>netstat -lntp</code>. Há outro comando de envio de requisição - <code>curl http://localhost</code> - que  devolve em html uma confirmação de que o web server está rodando.</p>
<h3 id="Forward-Ports"><a href="#Forward-Ports" class="headerlink" title="Forward Ports"></a>Forward Ports</h3><p><small>Vagrant &gt; Networking &gt; <a href="https://www.vagrantup.com/docs/networking/forwarded_ports.html" target="_blank" rel="noopener">Forward Ports</a></small></p>
<p>Podemos usar uma porta específica em Windows, o qual recebe a requisição e acessa a máquina virtual automaticamente através do processo de <em>Port Forwarding</em> na rede. Para definir esta chamada, é necessário adicionar a linha de configuração network no arquivo “Vagrantfile”, alterando para o host do Windows e salvando:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Vagrant.configure(<span class="string">"2"</span>) <span class="keyword">do</span> <span class="params">|config|</span></span><br><span class="line">    config.vm.network <span class="string">"forwarded_port"</span>, <span class="symbol">guest:</span> <span class="number">80</span>, <span class="symbol">host:</span><span class="number">8080</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>O <code>host</code> é o hospedeiro (o sistema que permite o guest (convidado) rodar) e o <code>guest</code> é a máquina virtual.</p>
<p>Depois é necessário parar a máquina virtual (<code>vagrant halt</code>) e subir de novo (<code>vagrant up</code>) para que essa configuração seja aplicada.<br>E depois, acessando o navegador com <code>localhost:8080</code> irá aparecer a página html que foi retornada com o comando <code>curl http://localhost</code> na máquina virtual!</p>
<h3 id="Rede-privada-static-ou-dhcp"><a href="#Rede-privada-static-ou-dhcp" class="headerlink" title="Rede privada (static ou dhcp)"></a>Rede privada (static ou dhcp)</h3><p>As configurações de rede privada permitem acessar a máquina virtual somente através do host - seu computador.</p>
<h4 id="IP-estatico"><a href="#IP-estatico" class="headerlink" title="IP estático"></a>IP estático</h4><h4 id="DHCP"><a href="#DHCP" class="headerlink" title="DHCP"></a>DHCP</h4><h3 id="Rede-publica-static-ou-dhcp"><a href="#Rede-publica-static-ou-dhcp" class="headerlink" title="Rede pública (static ou dhcp)"></a>Rede pública (static ou dhcp)</h3><p>As configuração de rede pública permitem acessar a máquina virtual através dos computadores em uma única rede pública.</p>
</div></article></div></main><footer><div class="paginator"><a class="next" href="/notebook/2020/02/06/linux-compactar-descompactar/">NEXT</a></div><div class="copyright"><p>© 2019 - 2020 <a href="https://alicefrancener.github.io">Alice Francener</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/claymcleod/hexo-theme-hermes" target="_blank">hexo-theme-hermes</a>. </p><p>Logo made by <a href="https://www.flaticon.com/authors/freepik" target="_blank" rel="noopener">Freepik</a> from <a href="https://flaticon.com" target="_blank" rel="noopener">www.flaticon.com</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>